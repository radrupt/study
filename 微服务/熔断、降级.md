# 降级
## 概念
服务降级一般是指在服务器压力剧增的时候，根据实际业务使用情况以及流量，对一些服务和页面有策略的不处理或者用一种简单的方式（默认值）进行处理，从而释放服务器的资源以保证核心业务的正常高效运行。
## 原因
服务器的资源是有限的，而请求是无限的。在用户使用即并发高峰期，会影响整体服务的性能，严重的话会导致宕机，以至于某些重要服务不可用。故高峰期为了保证核心功能服务的可用性，就需要对某些服务降级处理。可以理解为舍小保大
## 应用场景
多用于微服务架构中，一般当整个微服务架构整体的负载超出了预设的上限阈值（和服务器的配置性能有关系），或者即将到来的流量预计会超过预设的阈值时（比如双11、6.18等活动或者秒杀活动）
服务降级是从整个系统的负荷情况出发和考虑的，对某些负荷会比较高的情况，为了预防某些功能（业务场景）出现负荷过载或者响应慢的情况，在其内部暂时舍弃对一些非核心的接口和数据的请求，而直接返回一个提前准备好的fallback（退路）错误处理信息。这样，虽然提供的是一个有损的服务，但却保证了整个系统的稳定性和可用性

## 需要考虑的问题
1. 区分那些服务为核心？那些非核心
2. 降级策略（处理方式，一般指如何给用户友好的提示或者操作）
3. 自动降级还是手动降（配置中心）

# 熔断：应对雪崩效应的链路自我保护机制。可看作降级的特殊情况
## 概念
应对微服务雪崩效应的一种链路保护机制，类似股市、保险丝
## 原因
微服务之间的数据交互是通过远程调用来完成的。服务A调用服务B，服务B调用服务c，某一时间链路上对服务C的调用响应时间过长或者服务C不可用，随着时间的增长，对服务C的调用也越来越多，然后服务C崩溃了，但是链路调用还在，对服务B的调用也在持续增多，然后服务B崩溃，随之A也崩溃，导致雪崩效应

## 服务熔断是应对雪崩效应的一种微服务链路保护机制。例如在高压电路中，如果某个地方的电压过高，熔断器就会熔断，对电路进行保护。同样，在微服务架构中，熔断机制也是起着类似的作用。当调用链路的某个微服务不可用或者响应时间太长时，会进行服务熔断，不再有该节点微服务的调用，快速返回错误的响应信息。当检测到该节点微服务调用响应正常后，恢复调用链路

## 服务熔断的作用类似于我们家用的保险丝，当某服务出现不可用或响应超时的情况时，为了防止整个系统出现雪崩，暂时停止对该服务的调用

## 应用场景
微服务架构中，多个微服务相互调用出使用

## 需要考虑问题
1. 如何所依赖的服务对象不稳定
2. 失败之后如何快速恢复依赖对象，如何探知依赖对象是否恢复


# 服务降级和服务熔断区别
1. 触发原因不一样，服务熔断由链路上某个服务引起的，服务降级是从整体的负载考虑
2. 管理目标层次不一样，服务熔断是一个框架层次的处理，不关心具体业务，只要出现会导致雪崩的情况就尽快处理，服务降级是业务层次的处理，需要区分核心非核心功能
3. 实现方式不一样，服务熔断一般是自我熔断自我恢复，服务降级相当于人工控制
4. 触发原因不同 服务熔断一般是某个服务（下游服务）故障引起，而服务降级一般是从整体负荷考虑；

# 服务熔断是服务降级的一种特殊情况

# 服务降级是对系统整体资源的合理分配。区分核心服务和非核心服务。对某个服务的访问延迟时间、异常等情况做出预估并给出兜底方法。这是一种全局性的考量，对系统整体负荷进行管理。